<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Engineering Mock Test</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #2c3e50;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            margin: 0 20px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #00ff87, #60efff);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .test-area {
            padding: 40px;
        }

        .question-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #3498db;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .question-number {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9em;
        }

        .question-text {
            font-size: 1.2em;
            font-weight: 600;
            color: #2c3e50;
            margin: 20px 0;
            line-height: 1.4;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 15px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
            position: relative;
        }

        .option:hover {
            border-color: #3498db;
            background: #f8f9ff;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
        }

        .option.selected {
            border-color: #3498db;
            background: #e3f2fd;
        }

        .option.correct {
            border-color: #27ae60;
            background: #d5f4e6;
            animation: correctPulse 0.6s ease;
        }

        .option.incorrect {
            border-color: #e74c3c;
            background: #fdeaea;
            animation: incorrectShake 0.6s ease;
        }

        .option.disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        @keyframes correctPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        @keyframes incorrectShake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .option-letter {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #3498db;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .option.correct .option-letter {
            background: #27ae60;
        }

        .option.incorrect .option-letter {
            background: #e74c3c;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #95a5a6, #7f8c8d);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .explanation {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }

        .explanation.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .explanation h4 {
            color: #856404;
            margin-bottom: 10px;
        }

        .results {
            text-align: center;
            padding: 40px;
        }

        .score-display {
            font-size: 3em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .score-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            border-top: 4px solid #3498db;
        }

        .score-card.correct {
            border-top-color: #27ae60;
        }

        .score-card.incorrect {
            border-top-color: #e74c3c;
        }

        .score-card.skipped {
            border-top-color: #f39c12;
        }

        .score-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .start-screen {
            text-align: center;
            padding: 60px 40px;
        }

        .start-screen h2 {
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        .test-info {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
            text-align: left;
        }

        .test-info ul {
            list-style: none;
            padding: 0;
        }

        .test-info li {
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .test-info li:last-child {
            border-bottom: none;
        }

        .info-icon {
            width: 20px;
            height: 20px;
            background: #3498db;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            flex-shrink: 0;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header {
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .test-area {
                padding: 20px;
            }

            .progress-info {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .controls {
                flex-direction: column;
                gap: 15px;
            }

            .btn {
                width: 100%;
            }
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🎯 Engineering Mock Test</h1>
            <div id="progressInfo" class="progress-info hidden">
                <div>Page <span id="currentPage">1</span> of 6</div>
                <div class="progress-bar">
                    <div id="progressFill" class="progress-fill"></div>
                </div>
                <div>Score: <span id="currentScore">0</span></div>
            </div>
        </div>

        <div id="startScreen" class="start-screen">
            <h2>Welcome to the Engineering Mock Test</h2>
            <div class="test-info">
                <ul>
                    <li>
                        <div class="info-icon">📝</div>
                        <div><strong>Total Questions:</strong> 60 MCQs covering various engineering topics</div>
                    </li>
                    <li>
                        <div class="info-icon">📄</div>
                        <div><strong>Format:</strong> 10 questions per page (6 pages total)</div>
                    </li>
                    <li>
                        <div class="info-icon">✅</div>
                        <div><strong>Scoring:</strong> +1 mark for correct answer</div>
                    </li>
                    <li>
                        <div class="info-icon">❌</div>
                        <div><strong>Negative Marking:</strong> -0.2 marks for wrong answer (5 wrong = -1 mark)</div>
                    </li>
                    <li>
                        <div class="info-icon">⏭️</div>
                        <div><strong>Skip Option:</strong> Skip any individual question</div>
                    </li>
                    <li>
                        <div class="info-icon">🔄</div>
                        <div><strong>Random Order:</strong> Questions shuffled on each refresh</div>
                    </li>
                    <li>
                        <div class="info-icon">💡</div>
                        <div><strong>Instant Feedback:</strong> Correct (green), Wrong (red)</div>
                    </li>
                </ul>
            </div>
            <button class="btn btn-primary" onclick="startTest()" style="font-size: 1.2em; padding: 15px 40px;">
                🚀 Start Test
            </button>
        </div>

        <div id="testArea" class="test-area hidden">
            <div id="questionContainer" class="question-container">
                <!-- Questions will be loaded here -->
            </div>
            <div class="controls">
                <div>
                    <button id="prevBtn" class="btn btn-secondary" onclick="previousPage()" disabled>
                        ⬅️ Previous
                    </button>
                    <button id="nextBtn" class="btn btn-primary" onclick="nextPage()" disabled>
                        ${currentPage === 5 ? 'Finish Test' : 'Next ➡️'}
                    </button>
                </div>
            </div>
        </div>

        <div id="resultsArea" class="results hidden">
            <h2>🎉 Test Complete!</h2>
            <div id="scoreDisplay" class="score-display"></div>
            <div id="scoreBreakdown" class="score-breakdown"></div>
            <button class="btn btn-primary" onclick="restartTest()" style="margin-top: 30px;">
                🔄 Take Test Again
            </button>
        </div>
    </div>

    <script>
        const questions = [
            { q: "What is the primary function of a suspension system in a vehicle?", options: ["To increase engine power", "To absorb shocks and maintain stability", "To store fuel", "To cool the engine"], answer: 1, explanation: "The suspension system absorbs road shocks and ensures vehicle stability." }, // Easy - Automobiles
            { q: "Which principle explains the operation of a hydraulic lift?", options: ["Bernoulli's principle", "Pascal's law", "Archimedes' principle", "Newton's second law"], answer: 1, explanation: "Pascal's law allows hydraulic lifts to multiply force using fluid pressure." }, // Easy - Fluid Mechanics
            { q: "What is the specific heat capacity of aluminum?", options: ["0.90 J/g·°C", "0.38 J/g·°C", "2.0 J/g·°C", "4.18 J/g·°C"], answer: 0, explanation: "Aluminum's specific heat capacity is approximately 0.90 J/g·°C." }, // Easy - Thermodynamics
            { q: "Which material is known for its high electrical conductivity?", options: ["Steel", "Copper", "Ceramic", "Glass"], answer: 1, explanation: "Copper is widely used due to its excellent electrical conductivity." }, // Easy - Material Science
            { q: "What is the purpose of a ledger account in record keeping?", options: ["To design blueprints", "To track individual financial transactions", "To maintain tools", "To schedule maintenance"], answer: 1, explanation: "A ledger account records and summarizes financial transactions by category." }, // Easy - Record Keeping
            { q: "Which safety equipment protects against eye injuries?", options: ["Hard hat", "Safety goggles", "Earplugs", "Gloves"], answer: 1, explanation: "Safety goggles shield the eyes from debris and hazardous light." }, // Easy - Safety Practice
            { q: "What is the purpose of a maintenance logbook?", options: ["To increase downtime", "To record maintenance history", "To reduce staff", "To eliminate inspections"], answer: 1, explanation: "A logbook tracks maintenance activities for future reference." }, // Easy - Maintenance
            { q: "Which tool is used to measure angles in technical drawing?", options: ["Compass", "Protractor", "T-square", "Divider"], answer: 1, explanation: "A protractor accurately measures and draws angles in technical drawings." }, // Easy - Workshop & Drawing
            { q: "What is the purpose of a return on investment (ROI) calculation?", options: ["To design structures", "To measure profitability of an investment", "To measure strength", "To calculate speed"], answer: 1, explanation: "ROI calculates the gain or loss from an investment relative to its cost." }, // Easy - Engg Eco
            { q: "Which device is used to measure fluid pressure?", options: ["Thermometer", "Manometer", "Flowmeter", "Hygrometer"], answer: 1, explanation: "A manometer measures the pressure of a fluid or gas." }, // Easy - Fluid Mechanics
            { q: "What is the function of a crankshaft in an engine?", options: ["To store fuel", "To convert linear motion to rotary motion", "To cool the engine", "To generate electricity"], answer: 1, explanation: "The crankshaft transforms piston movement into rotational power." }, // Easy - Heat Engine
            { q: "Which type of stress occurs due to axial loading?", options: ["Shear stress", "Tensile stress", "Bending stress", "Torsional stress"], answer: 1, explanation: "Tensile stress results from forces pulling along an axis." }, // Easy - Engg Mechanics
            { q: "What is the purpose of a milling cutter in machining?", options: ["To measure dimensions", "To remove material and create shapes", "To smooth surfaces", "To cut threads"], answer: 1, explanation: "A milling cutter shapes workpieces by removing material." }, // Easy - Workshop & Drawing
            { q: "Which component regulates the fuel supply in a carburetor?", options: ["Throttle valve", "Float chamber", "Distributor", "Ignition coil"], answer: 1, explanation: "The float chamber controls the fuel level for consistent supply." }, // Easy - Automobiles
            { q: "What is the minimum service period for a promotion under TU 2050 Rules?", options: ["5 years", "10 years", "15 years", "20 years"], answer: 2, explanation: "A minimum of 15 years of service is required for promotion." }, // Easy - TU 2050 Rules
            { q: "Which gear type is used in high-speed applications?", options: ["Spur gear", "Helical gear", "Bevel gear", "Worm gear"], answer: 1, explanation: "Helical gears handle high speeds with smoother and quieter operation." }, // Mid-Hard - Automobiles
            { q: "What is the Darcy-Weisbach equation used for?", options: ["To calculate fluid velocity", "To determine head loss in pipes", "To measure pressure", "To assess buoyancy"], answer: 1, explanation: "The Darcy-Weisbach equation calculates frictional head loss in pipe flow." }, // Mid-Hard - Fluid Mechanics
            { q: "Which process is reversible in thermodynamics?", options: ["Free expansion", "Isentropic process", "Irreversible compression", "Adiabatic mixing"], answer: 1, explanation: "An isentropic process is reversible with no entropy change." }, // Mid-Hard - Thermodynamics
            { q: "What is the purpose of case hardening?", options: ["To soften the core", "To harden the surface while keeping the core tough", "To remove stresses", "To increase ductility"], answer: 1, explanation: "Case hardening creates a hard surface with a tough interior." }, // Mid-Hard - Material Science
            { q: "Which technique detects cracks in machinery?", options: ["Vibration analysis", "Ultrasonic testing", "Thermal imaging", "Oil analysis"], answer: 1, explanation: "Ultrasonic testing uses sound waves to detect internal cracks." }, // Mid-Hard - Maintenance
            { q: "What is the purpose of a dimension line in technical drawing?", options: ["To add color", "To indicate measurements", "To draw curves", "To show angles"], answer: 1, explanation: "A dimension line provides the length or size of a feature." }, // Mid-Hard - Workshop & Drawing
            { q: "Which factor increases the net present value (NPV)?", options: ["Higher discount rate", "Lower cash inflows", "Shorter project life", "Increased cash outflows"], answer: 0, explanation: "A lower discount rate increases NPV by reducing the present value deduction." }, // Mid-Hard - Engg Eco
            { q: "What is the condition for cavitation in a pump?", options: ["High pressure", "Low pressure below vapor pressure", "High temperature", "High flow rate"], answer: 1, explanation: "Cavitation occurs when pressure drops below the fluid's vapor pressure, forming bubbles." }, // Hard - Fluid Mechanics
            { q: "Which factor determines the efficiency of a heat exchanger?", options: ["Mass flow rate", "Heat transfer coefficient", "Surface area", "All of the above"], answer: 3, explanation: "Efficiency depends on mass flow, heat transfer coefficient, and surface area." }, // Hard - Heat Engine
            { q: "What is the slope of the shear force diagram for a uniformly distributed load?", options: ["Zero", "Constant", "Linear", "Parabolic"], answer: 0, explanation: "The shear force slope is zero under a uniform load, as it changes linearly." }, // Hard - Engg Mechanics
            { q: "Which alloy enhances the corrosion resistance of steel?", options: ["Nickel", "Chromium", "Manganese", "Silicon"], answer: 1, explanation: "Chromium forms a protective oxide layer, improving steel's corrosion resistance." }, // Hard - Material Science
            { q: "What is the entropy change in a closed system during a heat transfer?", options: ["Always zero", "Depends on heat and temperature", "Always positive", "Always negative"], answer: 1, explanation: "Entropy change is Q/T, where Q is heat and T is absolute temperature." }, // Hard - Thermodynamics
            { q: "Which safety rule requires emergency exits in TU buildings?", options: ["Fire Safety Act", "TU 2050 Rules", "Labor Code", "Building Regulations"], answer: 1, explanation: "TU 2050 Rules mandate emergency exits for safety compliance." }, // Hard - Safety Practice
            { q: "What is the purpose of a propeller shaft in a vehicle?", options: ["To change gears", "To transmit power to the wheels", "To store energy", "To reduce weight"], answer: 1, explanation: "The propeller shaft transfers power from the transmission to the differential." }, // Easy - Automobiles
            { q: "Which factor increases the Reynolds number?", options: ["Lower velocity", "Smaller pipe diameter", "Higher fluid viscosity", "Increased flow rate"], answer: 3, explanation: "A higher flow rate increases the Reynolds number, indicating turbulent flow." }, // Easy - Fluid Mechanics
            { q: "What is the function of a compressor in a refrigeration cycle?", options: ["To absorb heat", "To compress refrigerant gas", "To release heat", "To expand gas"], answer: 1, explanation: "The compressor raises the pressure and temperature of the refrigerant." }, // Easy - Heat Engine
            { q: "Which property determines a material's resistance to scratching?", options: ["Toughness", "Hardness", "Ductility", "Elasticity"], answer: 1, explanation: "Hardness measures a material's resistance to surface scratching or abrasion." }, // Easy - Material Science
            { q: "What is the purpose of a trial balance in record keeping?", options: ["To design machines", "To verify account balances", "To maintain tools", "To schedule work"], answer: 1, explanation: "A trial balance ensures debits and credits in accounts are equal." }, // Easy - Record Keeping
            { q: "Which safety practice prevents fire hazards?", options: ["Using grounded tools", "Storing flammable materials safely", "Wearing earplugs", "Using goggles"], answer: 1, explanation: "Safe storage of flammable materials reduces fire risk." }, // Easy - Safety Practice
            { q: "What is the purpose of a predictive maintenance program?", options: ["To increase downtime", "To predict and prevent failures", "To reduce costs", "To eliminate inspections"], answer: 1, explanation: "Predictive maintenance uses data to foresee and prevent equipment issues." }, // Easy - Maintenance
            { q: "Which tool is used to draw arcs in technical drawing?", options: ["Ruler", "Compass", "Set square", "Protractor"], answer: 1, explanation: "A compass draws precise arcs and circles in technical drawings." }, // Easy - Workshop & Drawing
            { q: "What is the purpose of a break-even chart in engineering economics?", options: ["To design bridges", "To show profit and loss points", "To measure strength", "To calculate speed"], answer: 1, explanation: "A break-even chart identifies the point where revenue equals costs." }, // Easy - Engg Eco
            { q: "Which component controls the exhaust gas in a turbocharger?", options: ["Wastegate", "Throttle valve", "Carburetor", "Injector"], answer: 0, explanation: "The wastegate regulates exhaust flow to control turbocharger speed." }, // Easy - Heat Engine
            { q: "What is the primary function of a cantilever beam?", options: ["To support weight on one end", "To store water", "To generate power", "To measure height"], answer: 0, explanation: "A cantilever beam supports loads with one fixed end." }, // Easy - Engg Mechanics
            { q: "त्रिभुवन विश्वविद्यालयको नियमावलीमा कति दिनको बिरामी विदा थप्न सकिन्छ?", options: ["५ दिन", "१० दिन", "१५ दिन", "२० दिन"], answer: 1, explanation: "१० दिनसम्म बिरामी विदा थप्न सकिन्छ।" }, // Easy - TU 2050 Rules
            { q: "त्रिभुवन विश्वविद्यालयमा कुन निकायले नियमावली संशोधन गर्छ?", options: ["रजिष्ट्रार", "कार्यकारी परिषद्", "सेवा आयोग", "उपकुलपति"], answer: 1, explanation: "कार्यकारी परिषद्ले नियमावली संशोधन गर्छ।" }, // Easy - TU 2050 Rules
            { q: "त्रिभुवन विश्वविद्यालयको नियमावलीमा कति वर्षको सेवा पछि विशेष भत्ता पाइन्छ?", options: ["१० वर्ष", "१५ वर्ष", "२० वर्ष", "२५ वर्ष"], answer: 2, explanation: "२० वर्षपछि विशेष भत्ता पाइन्छ।" }, // Mid-Hard - TU 2050 Rules
            { q: "त्रिभुवन विश्वविद्यालयको नियमावलीमा कुन समूहको वरियता तेस्रो छ?", options: ["प्रशिक्षण समूह", "प्रशासन समूह", "प्राविधिक समूह", "लेखा समूह"], answer: 2, explanation: "प्राविधिक समूहको वरियता तेस्रो छ।" }, // Mid-Hard - TU 2050 Rules
            { q: "त्रिभुवन विश्वविद्यालयको नियमावलीमा कति दिनको विशेष विदा दिइन्छ?", options: ["५ दिन", "७ दिन", "१० दिन", "१५ दिन"], answer: 1, explanation: "७ दिनको विशेष विदा दिइन्छ।" }, // Hard - TU 2050 Rules
            { q: "त्रिभुवन विश्वविद्यालयको नियमावलीमा कुन निकायले अनुशासन कारबाही गर्छ?", options: ["रजिष्ट्रार", "कार्यकारी परिषद्", "सेवा आयोग", "उपकुलपति"], answer: 1, explanation: "कार्यकारी परिषद्ले अनुशासन कारबाही गर्छ।" }, // Hard - TU 2050 Rules
        ];

        let shuffledQuestions = [];
        let currentPage = 0;
        let userAnswers = {};
        let score = 0;
        let correctAnswers = 0;
        let wrongAnswers = 0;
        let skippedQuestions = 0;
        const questionsPerPage = 10;
        const totalPages = 6;

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startTest() {
            shuffledQuestions = shuffleArray([...questions]);
            currentPage = 0;
            userAnswers = {};
            score = 0;
            correctAnswers = 0;
            wrongAnswers = 0;
            skippedQuestions = 0;

            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('testArea').classList.remove('hidden');
            document.getElementById('progressInfo').classList.remove('hidden');
            loadPage();
        }

        function loadPage() {
            const startIndex = currentPage * questionsPerPage;
            const endIndex = Math.min(startIndex + questionsPerPage, shuffledQuestions.length);
            let html = '';
            for (let i = startIndex; i < endIndex; i++) {
                const q = shuffledQuestions[i];
                html += `
                    <div class="question-container" id="question-${i}">
                        <div class="question-header">
                            <div class="question-number">Question ${i + 1}</div>
                        </div>
                        <div class="question-text">${q.q}</div>
                        <div class="options-container">
                            ${q.options.map((opt, idx) => `
                                <div class="option" onclick="selectOption(${i}, ${idx})" id="option-${i}-${idx}">
                                    <div class="option-letter">${String.fromCharCode(65 + idx)}</div>
                                    <div>${opt}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="explanation" id="explanation-${i}">
                            <h4>💡 Explanation:</h4>
                            <p>${q.explanation}</p>
                        </div>
                        <button class="btn btn-warning skip-btn" onclick="skipQuestion(${i})" id="skip-${i}">⏭️ Skip</button>
                    </div>
                `;
            }

            document.getElementById('questionContainer').innerHTML = html;
            updateProgress();
            updateScore();
            updateNavigationButtons();
        }

        function selectOption(questionIndex, optionIndex) {
            const question = shuffledQuestions[questionIndex];
            const isCorrect = optionIndex === question.answer;

            userAnswers[questionIndex] = optionIndex;

            const options = document.querySelectorAll(`#question-${questionIndex} .option`);
            options.forEach((opt, idx) => {
                opt.classList.remove('selected', 'correct', 'incorrect', 'disabled');
                if (idx === optionIndex) opt.classList.add('selected');
                if (idx === question.answer) opt.classList.add('correct');
                else if (idx === optionIndex && !isCorrect) opt.classList.add('incorrect');
                opt.classList.add('disabled');
            });

            document.getElementById(`explanation-${questionIndex}`).classList.add('show');
            document.getElementById(`skip-${questionIndex}`).style.display = 'none';

            if (isCorrect) {
                score += 1;
            } else {
                score -= 0.2;
            }

            if (isCorrect && (questionIndex in userAnswers ? userAnswers[questionIndex] !== question.answer : true)) {
                correctAnswers++;
            } else if (!isCorrect && (questionIndex in userAnswers ? userAnswers[questionIndex] === question.answer : false)) {
                wrongAnswers++;
            }

            updateScore();
            updateNavigationButtons();
        }

        function skipQuestion(questionIndex) {
            userAnswers[questionIndex] = 'skipped';
            skippedQuestions++;
            document.getElementById(`question-${questionIndex}`).classList.add('skipped');
            document.getElementById(`skip-${questionIndex}`).style.display = 'none';
            const options = document.querySelectorAll(`#question-${questionIndex} .option`);
            options.forEach(opt => {
                opt.classList.add('disabled');
            });
            updateScore();
            updateNavigationButtons();
        }

        function nextPage() {
            if (currentPage < totalPages - 1) {
                currentPage++;
                loadPage();
            } else {
                showResults();
            }
        }

        function previousPage() {
            if (currentPage > 0) {
                currentPage--;
                loadPage();
            }
        }

        function updateProgress() {
            const progress = ((currentPage + 1) / totalPages) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            document.getElementById('currentPage').textContent = currentPage + 1;
        }

        function updateScore() {
            const negative = Math.floor(wrongAnswers / 5) * 1;
            const totalScore = score - negative;
            document.getElementById('currentScore').textContent = Math.round(totalScore * 10) / 10;
        }

        function updateNavigationButtons() {
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');

            prevBtn.disabled = currentPage === 0;
            nextBtn.disabled = currentPage === totalPages - 1;
            if (currentPage === totalPages - 1) {
                nextBtn.textContent = 'Finish Test';
            } else {
                nextBtn.textContent = 'Next ➡️';
            }

            const startIndex = currentPage * questionsPerPage;
            const endIndex = Math.min(startIndex + questionsPerPage, shuffledQuestions.length);
            let allAnswered = true;
            for (let i = startIndex; i < endIndex; i++) {
                if (!(i in userAnswers)) {
                    allAnswered = false;
                    break;
                }
            }
            nextBtn.disabled = !allAnswered && currentPage < totalPages - 1;
        }

        function showResults() {
            correctAnswers = 0;
            wrongAnswers = 0;
            skippedQuestions = 0;
            for (let i = 0; i < shuffledQuestions.length; i++) {
                if (userAnswers[i] === 'skipped' || !(i in userAnswers)) {
                    skippedQuestions++;
                } else if (userAnswers[i] === shuffledQuestions[i].answer) {
                    correctAnswers++;
                } else {
                    wrongAnswers++;
                }
            }
            score = correctAnswers - Math.floor(wrongAnswers / 5);

            document.getElementById('testArea').classList.add('hidden');
            document.getElementById('progressInfo').classList.add('hidden');
            document.getElementById('scoreDisplay').innerHTML = `
                <div style="color: #27ae60; font-size: 0.8em;">Final Score</div>
                ${Math.round(score * 10) / 10} / ${shuffledQuestions.length}
                <div style="color: #7f8c8d; font-size: 0.5em; margin-top: 10px;">
                    (${((correctAnswers / shuffledQuestions.length) * 100).toFixed(1)}% Correct)
                </div>
            `;
            document.getElementById('scoreBreakdown').innerHTML = `
                <div class="score-card correct">
                    <div class="score-number" style="color: #27ae60;">${correctAnswers}</div>
                    <div>Correct Answers</div>
                </div>
                <div class="score-card incorrect">
                    <div class="score-number" style="color: #e74c3c;">${wrongAnswers}</div>
                    <div>Wrong Answers</div>
                </div>
                <div class="score-card skipped">
                    <div class="score-number" style="color: #f39c12;">${skippedQuestions}</div>
                    <div>Skipped Questions</div>
                </div>
                <div class="score-card">
                    <div class="score-number" style="color: #3498db;">${Math.round(score * 10) / 10}</div>
                    <div>Net Score<br><small>(After -0.2 penalty)</small></div>
                </div>
            `;
            document.getElementById('resultsArea').classList.remove('hidden');
        }

        function restartTest() {
            document.getElementById('resultsArea').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('startScreen').classList.remove('hidden');
        });
    </script>
</body>
</html>
